---
import MainLayout from "../layouts/MainLayout.astro";
import Container from "../components/Container.astro";

const books = [
  {
    title: "Staff Engineer",
    author: "Will Larson",
    slug: "staff-engineer",
    status: "Finished",
    rating: 5,
    date: "2024-07-02",
    formattedDate: "Jul 2, 2024",
    description:
      "Essential guide for senior engineers looking to grow into staff+ roles. Covers technical leadership, system design, and career progression.",
    tags: ["leadership", "career", "engineering-management"],
    cover: "/books/staff-engineer.jpg",
    featured: true,
  },
  {
    title: "Accelerate",
    author: "Nicole Forsgren, Jez Humble, Gene Kim",
    slug: "accelerate",
    status: "Finished",
    rating: 4,
    date: "2024-05-09",
    formattedDate: "May 9, 2024",
    description:
      "Data-driven insights into what makes high-performing technology organizations. Great for understanding DevOps and delivery metrics.",
    tags: ["devops", "performance", "metrics"],
    cover: "/books/accelerate.jpg",
    featured: true,
  },
  {
    title: "Thinking in Systems",
    author: "Donella Meadows",
    slug: "thinking-in-systems",
    status: "Finished",
    rating: 4,
    date: "2024-03-21",
    formattedDate: "Mar 21, 2024",
    description:
      "A primer on systems thinking that's incredibly relevant for understanding complex software architectures and organizational dynamics.",
    tags: ["systems-thinking", "complexity", "architecture"],
    cover: "/books/thinking-in-systems.jpg",
    featured: true,
  },
  {
    title: "Building Microservices",
    author: "Sam Newman",
    slug: "building-microservices",
    status: "Reading",
    rating: null,
    date: "2024-01-15",
    formattedDate: "Jan 15, 2024",
    description:
      "Currently reading through this comprehensive guide to microservices architecture, which has been invaluable for my work at Coolblue.",
    tags: ["microservices", "architecture", "distributed-systems"],
    cover: "/books/building-microservices.jpg",
    featured: false,
  },
  {
    title: "Designing Data-Intensive Applications",
    author: "Martin Kleppmann",
    slug: "designing-data-intensive-applications",
    status: "Finished",
    rating: 5,
    date: "2023-11-30",
    formattedDate: "Nov 30, 2023",
    description:
      "Deep dive into the fundamentals of data systems. Essential reading for understanding distributed systems, databases, and data processing.",
    tags: ["databases", "distributed-systems", "data"],
    cover: "/books/ddia.jpg",
    featured: false,
  },
  {
    title: "The Phoenix Project",
    author: "Gene Kim, Kevin Behr, George Spafford",
    slug: "phoenix-project",
    status: "Finished",
    rating: 4,
    date: "2023-09-15",
    formattedDate: "Sep 15, 2023",
    description:
      "A novel about IT work and DevOps. Entertaining way to learn about bottlenecks, constraints, and improving software delivery.",
    tags: ["devops", "process-improvement", "novel"],
    cover: "/books/phoenix-project.jpg",
    featured: false,
  },
  {
    title: "Clean Code",
    author: "Robert C. Martin",
    slug: "clean-code",
    status: "Finished",
    rating: 3,
    date: "2023-06-10",
    formattedDate: "Jun 10, 2023",
    description:
      "Classic book on writing maintainable code. Some concepts feel dated, but the core principles remain valuable for any developer.",
    tags: ["code-quality", "refactoring", "best-practices"],
    cover: "/books/clean-code.jpg",
    featured: false,
  },
];

const statusColors = {
  Reading: "blue",
  Finished: "green",
  Shelved: "orange",
};

const featuredBooks = books.filter((book) => book.featured);
const otherBooks = books.filter((book) => !book.featured);

function renderStars(rating) {
  if (!rating) return "";
  return "â˜…".repeat(rating) + "â˜†".repeat(5 - rating);
}
---

<MainLayout
  title="Books â€” Wessel van Lit"
  description="Book reviews and reading notes by Wessel van Lit on software engineering, systems design, and technology leadership."
>
  <Container>
    <header>
      <h1>Books</h1>
      <p class="intro">
        Books that have shaped my thinking about software engineering, system
        design, and technology leadership. A mix of technical deep dives and
        practical guides for building better systems and teams.
      </p>
    </header>

    <section class="featured" aria-labelledby="featured-heading">
      <h2 id="featured-heading" class="section-title">Recently Read</h2>
      <div class="featured-grid">
        {
          featuredBooks.map((book) => (
            <article class="book-card featured-book">
              <div class="book-cover-placeholder" aria-hidden="true">
                ðŸ“š
              </div>
              <div class="book-content">
                <div class="book-header">
                  <h3 class="book-title">
                    <a href={`/books/${book.slug}`}>{book.title}</a>
                  </h3>
                  <div class="book-meta">
                    <span class="author">{book.author}</span>
                    <div class="status-rating">
                      <span
                        class={`status status-${statusColors[book.status]}`}
                      >
                        {book.status}
                      </span>
                      {book.rating && (
                        <span
                          class="rating"
                          aria-label={`Rating: ${book.rating} out of 5 stars`}
                        >
                          {renderStars(book.rating)}
                        </span>
                      )}
                    </div>
                    <time class="date">{book.formattedDate}</time>
                  </div>
                </div>
                <p class="book-description">{book.description}</p>
                <div class="tags">
                  {book.tags.map((tag) => (
                    <span class="tag">{tag}</span>
                  ))}
                </div>
              </div>
            </article>
          ))
        }
      </div>
    </section>

    <section class="all-books" aria-labelledby="all-books-heading">
      <h2 id="all-books-heading" class="section-title">All Books</h2>

      <div class="books-list">
        {
          otherBooks.map((book) => (
            <article class="book-item">
              <div class="book-cover-small" aria-hidden="true">
                ðŸ“–
              </div>
              <div class="book-content">
                <div class="book-header">
                  <h3 class="book-title">
                    <a href={`/books/${book.slug}`}>{book.title}</a>
                  </h3>
                  <div class="book-meta">
                    <span class="author">{book.author}</span>
                    <div class="status-rating">
                      <span
                        class={`status status-${statusColors[book.status]}`}
                      >
                        {book.status}
                      </span>
                      {book.rating && (
                        <span
                          class="rating"
                          aria-label={`Rating: ${book.rating} out of 5 stars`}
                        >
                          {renderStars(book.rating)}
                        </span>
                      )}
                    </div>
                    <time class="date">{book.formattedDate}</time>
                  </div>
                </div>
                <p class="book-description">{book.description}</p>
                <div class="tags">
                  {book.tags.map((tag) => (
                    <span class="tag">{tag}</span>
                  ))}
                </div>
              </div>
            </article>
          ))
        }
      </div>
    </section>
  </Container>
</MainLayout>

<style>
  header {
    margin-bottom: 48px;
  }

  h1 {
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 700;
    margin-bottom: 16px;
  }

  .intro {
    font-size: 1.125rem;
    color: var(--color-text-secondary, #666);
    max-width: 60ch;
  }

  .section-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 24px;
    color: var(--color-text-primary, #1a1a1a);
  }

  /* Featured Books */
  .featured {
    margin-bottom: 48px;
  }

  .featured-grid {
    display: grid;
    gap: 24px;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  }

  .book-card {
    background: var(--color-bg-secondary, #f8fafc);
    border: 1px solid var(--color-border, #e1e5e9);
    border-radius: 12px;
    padding: 24px;
    transition: all 0.2s ease;
  }

  .book-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    border-color: var(--color-primary, #3b82f6);
  }

  .featured-book {
    display: flex;
    gap: 20px;
    align-items: flex-start;
  }

  .book-cover-placeholder {
    font-size: 3rem;
    line-height: 1;
    flex-shrink: 0;
    width: 80px;
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-bg-tertiary, #e2e8f0);
    border-radius: 8px;
  }

  .book-content {
    flex: 1;
    min-width: 0;
  }

  /* Book Items */
  .all-books {
    margin-top: 48px;
  }

  .books-list {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .book-item {
    display: flex;
    gap: 16px;
    padding: 20px 0;
    border-bottom: 1px solid var(--color-border, #e1e5e9);
  }

  .book-item:last-child {
    border-bottom: none;
  }

  .book-cover-small {
    font-size: 1.5rem;
    flex-shrink: 0;
    width: 40px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-bg-tertiary, #e2e8f0);
    border-radius: 4px;
  }

  .book-header {
    margin-bottom: 12px;
  }

  .book-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0 0 8px 0;
  }

  .book-title a {
    color: var(--color-text-primary, #1a1a1a);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .book-title a:hover {
    color: var(--color-primary, #3b82f6);
  }

  .book-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    align-items: center;
    font-size: 0.875rem;
  }

  .author {
    color: var(--color-text-secondary, #666);
    font-weight: 500;
  }

  .status-rating {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .status {
    font-size: 0.75rem;
    font-weight: 600;
    padding: 4px 8px;
    border-radius: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .status-green {
    background: #dcfce7;
    color: #166534;
  }

  .status-blue {
    background: #dbeafe;
    color: #1e40af;
  }

  .status-orange {
    background: #fed7aa;
    color: #c2410c;
  }

  .rating {
    color: #fbbf24;
    font-size: 0.875rem;
    line-height: 1;
  }

  .date {
    color: var(--color-text-secondary, #666);
  }

  .book-description {
    margin-bottom: 16px;
    line-height: 1.6;
    color: var(--color-text-secondary, #666);
    max-width: 65ch;
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  .tag {
    font-size: 0.75rem;
    font-weight: 500;
    padding: 4px 8px;
    background: var(--color-bg-tertiary, #e2e8f0);
    color: var(--color-text-secondary, #64748b);
    border-radius: 6px;
    border: 1px solid var(--color-border-light, #cbd5e1);
  }

  @media (max-width: 768px) {
    .featured-grid {
      grid-template-columns: 1fr;
    }

    .featured-book {
      flex-direction: column;
      text-align: center;
    }

    .book-cover-placeholder {
      align-self: center;
    }

    .book-item {
      flex-direction: column;
      gap: 12px;
    }

    .book-cover-small {
      align-self: flex-start;
    }

    .book-meta {
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
    }
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    :root {
      --color-bg: #1a1a1a;
      --color-bg-secondary: #2d2d2d;
      --color-bg-tertiary: #404040;
      --color-text-primary: #ffffff;
      --color-text-secondary: #a1a1aa;
      --color-border: #404040;
      --color-border-light: #525252;
      --color-primary: #60a5fa;
    }

    .status-green {
      background: #166534;
      color: #dcfce7;
    }

    .status-blue {
      background: #1e40af;
      color: #dbeafe;
    }

    .status-orange {
      background: #c2410c;
      color: #fed7aa;
    }
  }
</style>
