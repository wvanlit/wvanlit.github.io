---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";

const posts = await getCollection("blog");
const toTime = (dateString: string) => {
    const time = Date.parse(dateString);
    return Number.isNaN(time) ? 0 : time;
};
const recentPosts = posts
    .sort((a, b) => toTime(b.data.date) - toTime(a.data.date))
    .slice(0, 5);
---

<BaseLayout>
    <div class="intro">
        <p>
            I'm a developer and writer. I work at Coolblue building distributed
            systems. I've been coding for 10 years and working professionally
            for 6.
        </p>
        <p>
            My life's work is to make technology reliable and systems easy to
            understand. I'm passionate about event-driven architectures, C#
            microservices, and pragmatic engineering.
        </p>
    </div>

    <section>
        <h2 class="section-title">Writing</h2>
        <ul class="post-list">
            {
                recentPosts.map((post) => (
                    <li class="post-item">
                        <a href={`/writing/${post.slug}/`} class="post-link">
                            <span class="post-title">{post.data.title}</span>
                            <span class="post-date">{post.data.date}</span>
                        </a>
                    </li>
                ))
            }
        </ul>
    </section>
</BaseLayout>
